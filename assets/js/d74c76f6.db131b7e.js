"use strict";(self.webpackChunkchia_docs=self.webpackChunkchia_docs||[]).push([[400],{3905:(e,a,t)=>{t.d(a,{Zo:()=>p,kt:()=>m});var n=t(7294);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function c(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?c(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function r(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=n.createContext({}),o=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},p=function(e){var a=o(e.components);return n.createElement(s.Provider,{value:a},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var t=e.components,l=e.mdxType,c=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),d=o(t),u=l,m=d["".concat(s,".").concat(u)]||d[u]||h[u]||c;return t?n.createElement(m,i(i({ref:a},p),{},{components:t})):n.createElement(m,i({ref:a},p))}));function m(e,a){var t=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var c=t.length,i=new Array(c);i[0]=u;var r={};for(var s in a)hasOwnProperty.call(a,s)&&(r[s]=a[s]);r.originalType=e,r[d]="string"==typeof e?e:l,i[1]=r;for(var o=2;o<c;o++)i[o]=t[o];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5162:(e,a,t)=>{t.d(a,{Z:()=>i});var n=t(7294),l=t(6010);const c={tabItem:"tabItem_Ymn6"};function i(e){let{children:a,hidden:t,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,l.Z)(c.tabItem,i),hidden:t},a)}},4866:(e,a,t)=>{t.d(a,{Z:()=>N});var n=t(7462),l=t(7294),c=t(6010),i=t(2466),r=t(6550),s=t(1980),o=t(7392),p=t(12);function d(e){return function(e){return l.Children.map(e,(e=>{if((0,l.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:l}}=e;return{value:a,label:t,attributes:n,default:l}}))}function h(e){const{values:a,children:t}=e;return(0,l.useMemo)((()=>{const e=a??d(t);return function(e){const a=(0,o.l)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function u(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function m(e){let{queryString:a=!1,groupId:t}=e;const n=(0,r.k6)(),c=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,s._X)(c),(0,l.useCallback)((e=>{if(!c)return;const a=new URLSearchParams(n.location.search);a.set(c,e),n.replace({...n.location,search:a.toString()})}),[c,n])]}function b(e){const{defaultValue:a,queryString:t=!1,groupId:n}=e,c=h(e),[i,r]=(0,l.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!u({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:c}))),[s,o]=m({queryString:t,groupId:n}),[d,b]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[n,c]=(0,p.Nk)(t);return[n,(0,l.useCallback)((e=>{t&&c.set(e)}),[t,c])]}({groupId:n}),k=(()=>{const e=s??d;return u({value:e,tabValues:c})?e:null})();(0,l.useLayoutEffect)((()=>{k&&r(k)}),[k]);return{selectedValue:i,selectValue:(0,l.useCallback)((e=>{if(!u({value:e,tabValues:c}))throw new Error(`Can't select invalid tab value=${e}`);r(e),o(e),b(e)}),[o,b,c]),tabValues:c}}var k=t(2389);const w={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(e){let{className:a,block:t,selectedValue:r,selectValue:s,tabValues:o}=e;const p=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.o5)(),h=e=>{const a=e.currentTarget,t=p.indexOf(a),n=o[t].value;n!==r&&(d(a),s(n))},u=e=>{let a=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const t=p.indexOf(e.currentTarget)+1;a=p[t]??p[0];break}case"ArrowLeft":{const t=p.indexOf(e.currentTarget)-1;a=p[t]??p[p.length-1];break}}a?.focus()};return l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,c.Z)("tabs",{"tabs--block":t},a)},o.map((e=>{let{value:a,label:t,attributes:i}=e;return l.createElement("li",(0,n.Z)({role:"tab",tabIndex:r===a?0:-1,"aria-selected":r===a,key:a,ref:e=>p.push(e),onKeyDown:u,onClick:h},i,{className:(0,c.Z)("tabs__item",w.tabItem,i?.className,{"tabs__item--active":r===a})}),t??a)})))}function g(e){let{lazy:a,children:t,selectedValue:n}=e;if(t=Array.isArray(t)?t:[t],a){const e=t.find((e=>e.props.value===n));return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return l.createElement("div",{className:"margin-top--md"},t.map(((e,a)=>(0,l.cloneElement)(e,{key:a,hidden:e.props.value!==n}))))}function v(e){const a=b(e);return l.createElement("div",{className:(0,c.Z)("tabs-container",w.tabList)},l.createElement(f,(0,n.Z)({},e,a)),l.createElement(g,(0,n.Z)({},e,a)))}function N(e){const a=(0,k.Z)();return l.createElement(v,(0,n.Z)({key:String(a)},e))}},7664:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var n=t(7462),l=(t(7294),t(3905)),c=t(4866),i=t(5162);const r={slug:"/guides/clawback-primitive-guide",title:"Clawback Primitive Guide"},s=void 0,o={unversionedId:"guides/clawback-primitive-guide",id:"guides/clawback-primitive-guide",title:"Clawback Primitive Guide",description:"Intro",source:"@site/docs/guides/clawback-primitive-guide.md",sourceDirName:"guides",slug:"/guides/clawback-primitive-guide",permalink:"/guides/clawback-primitive-guide",draft:!1,editUrl:"https://github.com/Chia-Network/{{ REPOSITORY_NAME }}/blob/main/docs/guides/clawback-primitive-guide.md",tags:[],version:"current",frontMatter:{slug:"/guides/clawback-primitive-guide",title:"Clawback Primitive Guide"},sidebar:"guides",previous:{title:"Seeder User Guide",permalink:"/guides/seeder-user-guide"},next:{title:"Why Chia is Great",permalink:"/guides/why-chia-is-great-video-series"}},p={},d=[{value:"Intro",id:"intro",level:2},{value:"About clawback",id:"about-clawback",level:3},{value:"Install the clawback primitive",id:"install-the-clawback-primitive",level:3},{value:"Create a clawback coin",id:"create-a-clawback-coin",level:3},{value:"Claw back a coin",id:"claw-back-a-coin",level:3},{value:"Claim a clawback coin",id:"claim-a-clawback-coin",level:3},{value:"Other cases",id:"other-cases",level:3},{value:"Sender performs a clawback after the timelock",id:"sender-performs-a-clawback-after-the-timelock",level:4},{value:"Recipient attempts to claim clawback coin before timelock has expired",id:"recipient-attempts-to-claim-clawback-coin-before-timelock-has-expired",level:4},{value:"Someone other than the Sender attempts to claw back a coin",id:"someone-other-than-the-sender-attempts-to-claw-back-a-coin",level:4},{value:"Someone other than the Recipient attempts to claim a clawback spend",id:"someone-other-than-the-recipient-attempts-to-claim-a-clawback-spend",level:4},{value:"Sender claws back coin to a new wallet",id:"sender-claws-back-coin-to-a-new-wallet",level:4},{value:"Recipient claims a clawback coin in a new wallet address",id:"recipient-claims-a-clawback-coin-in-a-new-wallet-address",level:4},{value:"Sender or Recipient attempts to show a clawback coin before it has been created",id:"sender-or-recipient-attempts-to-show-a-clawback-coin-before-it-has-been-created",level:4}],h={toc:d},u="wrapper";function m(e){let{components:a,...t}=e;return(0,l.kt)(u,(0,n.Z)({},h,t,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"intro"},"Intro"),(0,l.kt)("p",null,"This document will show you how to use Chia's clawback primitive. Clawback currently is implemented as a command-line tool only. Wallet developers are welcome to integrate it into their GUI wallets. For additional technical resources, see the following:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/clawback_cli"},"Clawback CLI Reference")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=_pC38ulU2js"},"Youtube video explaining clawback"))),(0,l.kt)("admonition",{title:"some important notes",type:"warning"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"The clawback primitive doesn't implement wallet functionality to handle incoming clawbacks and resync deleted coin stores. Rather, it's for developers to understand the process of how clawbacks work."),(0,l.kt)("li",{parentName:"ul"},"Chia Network, Inc will add a user-friendly implementation of the clawback primitive to a future release of the reference wallet."),(0,l.kt)("li",{parentName:"ul"},"A ",(0,l.kt)("strong",{parentName:"li"},"synced full node")," AND a synced wallet are required to use the clawback primitive."),(0,l.kt)("li",{parentName:"ul"},"You are recommended to test the clawback primitive on either the testnet or a simulator before moving to mainnet. For your reference, this guide will use testnet10."),(0,l.kt)("li",{parentName:"ul"},"The clawback primitive currently only supports XCH/TXCH. It does not support CATs or NFTs. The ",(0,l.kt)("inlineCode",{parentName:"li"},"-w")," flag will be ignored if it points to a non-XCH (or TXCH) wallet."))),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"about-clawback"},"About clawback"),(0,l.kt)("p",null,'The clawback primitive was designed to guard against sending Chia assets to an incorrect address. The principal behind clawback is simple: it is an intermediate coin that cannot be sent to the destination address until a timelock has expired. In the meantime, the Sender can "claw back" the coin, returning it to their wallet in the form of standard XCH.'),(0,l.kt)("p",null,"An Alice-Bob will demonstrate this:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Alice wants to send 1 XCH to Bob, and she wants to verify that she has entered Bob's address correctly in her wallet."),(0,l.kt)("li",{parentName:"ul"},"With this in mind, Alice creates a clawback coin with the following features:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"It exists on Chia's blockchain"),(0,l.kt)("li",{parentName:"ul"},"It is viewable by Alice's and Bob's wallets, as well as by block explorers"),(0,l.kt)("li",{parentName:"ul"},"It is worth 1 XCH, funded from Alice's wallet"),(0,l.kt)("li",{parentName:"ul"},"It has a 1-hour timelock"),(0,l.kt)("li",{parentName:"ul"},"It contains Alice's address as its clawback destination (Alice -- and no one else -- can modify this later)"),(0,l.kt)("li",{parentName:"ul"},"It contains Bob's address as its final destination (Bob -- and no one else -- can modify this later)"))),(0,l.kt)("li",{parentName:"ul"},"The clawback coin therefore contains the following logic for how it may be spent:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Before 1 hour has elapsed since the coin's creation, Alice can use ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/puzzles/p2_m_of_n_delegate_direct.clvm"},"p2_1_of_n")," to spend the coin using the same public/private key pair that created the coin. When the coin is spent in this way, a new coin is created using ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/puzzles/p2_puzzle_hash.clvm"},"p2_puzzle_hash"),". Typically, this coin will be created in Alice's wallet, but it could be created in another wallet instead. The new coin uses the standard Chia puzzle. This is the ",(0,l.kt)("inlineCode",{parentName:"li"},"clawback")," case."),(0,l.kt)("li",{parentName:"ul"},"Before 1 hour has elapsed since the coin's creation, nobody other than Alice may spend it"),(0,l.kt)("li",{parentName:"ul"},"After 1 hour, the timelock elapses. At this point Bob can spend the clawback coin. When this spend occurs, by default a new standard XCH coin is created in Bob's wallet. Bob can also pass in a different address than the one he originally specified if he so chooses."),(0,l.kt)("li",{parentName:"ul"},"Note that the coin's clawback logic is in place for the life of the coin. This means that until the coin is spent, Alice is able to claw it back. This is true regardless of the coin's age. Because of this, after the timelock expires, Bob must spend the clawback coin in order to receive the XCH in his wallet. After this spend has completed, the clawback coin no longer exists, and the spend is final.")))),(0,l.kt)("p",null,"This guide will show you how to perform the logic outlined above:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Create a clawback coin"),(0,l.kt)("li",{parentName:"ul"},"Claw back the coin"),(0,l.kt)("li",{parentName:"ul"},"Claim the clawback coin")),(0,l.kt)("p",null,"As well as a few other interesting clawback cases."),(0,l.kt)("p",null,"We'll start by showing you how to install the clawback primitive. This guide assumes you are running a Chia node and wallet, using mainnet, the testnet, or a simulator."),(0,l.kt)("admonition",{title:"important",type:"warning"},(0,l.kt)("p",{parentName:"admonition"},"The values used in the commands from this guide are just examples. You will need to update them with the equivalent values from your local node.")),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"install-the-clawback-primitive"},"Install the clawback primitive"),(0,l.kt)("p",null,"The clawback primitive is included in the ",(0,l.kt)("inlineCode",{parentName:"p"},"Chia-Network")," organization's ",(0,l.kt)("inlineCode",{parentName:"p"},"chia-clawback-primitive")," GitHub repository."),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Open a new terminal window and run the following command to clone the ",(0,l.kt)("inlineCode",{parentName:"p"},"chia-clawback-primitive")," repository, using the ",(0,l.kt)("inlineCode",{parentName:"p"},"main")," branch:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/Chia-Network/chia-clawback-primitive.git -b main\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Change to the cloned repository:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd chia-clawback-primitive\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Create and activate a virtual environment:"),(0,l.kt)(c.Z,{defaultValue:"windows",groupId:"os",values:[{label:"Windows",value:"windows"},{label:"Linux",value:"linux"},{label:"macOS",value:"macos"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"windows",mdxType:"TabItem"},(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"python -m venv venv\n.\\venv\\Scripts\\Activate.ps1\n"))),(0,l.kt)(i.Z,{value:"linux",mdxType:"TabItem"},(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"python3 -m venv venv\n. ./venv/bin/activate\n"))),(0,l.kt)(i.Z,{value:"macos",mdxType:"TabItem"},(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"python3 -m venv venv\n. ./venv/bin/activate\n"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Install the clawback primitive:"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"pip install .[dev]\n")),(0,l.kt)("p",null,"Several packages will be installed, including a bundled copy of ",(0,l.kt)("inlineCode",{parentName:"p"},"chia-blockchain"),". This process will typically take a few minutes."),(0,l.kt)("ol",{start:5},(0,l.kt)("li",{parentName:"ol"},"The clawback primitive should now be installed and configured properly. To test it, run:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback --version\n")),(0,l.kt)("p",null,"You should be shown the current version of the clawback primitive. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback, version 0.1.dev19\n")),(0,l.kt)("p",null,"At this point, you are ready to use the clawback primitive."),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"create-a-clawback-coin"},"Create a clawback coin"),(0,l.kt)("p",null,"For this example, we will use two wallets: a Sender and a Recipient. The Sender has a balance of 10 TXCH and the Recipient has 0 TXCH."),(0,l.kt)("p",null,"For your reference, here is the Sender wallet's info:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 3807629793\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2391281\nSync status: Synced\nBalances, fingerprint: 3807629793\n\nChia Wallet:\n   -Total Balance:         8.0 txch (8000000000000 mojo)\n   -Pending Total Balance: 8.0 txch (8000000000000 mojo)\n   -Spendable:             8.0 txch (8000000000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"To create the clawback coin from the Sender's wallet, run the ",(0,l.kt)("a",{parentName:"p",href:"/clawback_cli#create"},"clawback create")," command. The ",(0,l.kt)("inlineCode",{parentName:"p"},"-t")," (Recipient's address) and ",(0,l.kt)("inlineCode",{parentName:"p"},"-a")," (amount in XCH/TXCH) flags are required. By default, the clawback coin will be locked for two weeks. For this demo, we will override the default by using the ",(0,l.kt)("inlineCode",{parentName:"p"},"-t")," flag to specify a timelock period of 600 seconds. We will also use the ",(0,l.kt)("inlineCode",{parentName:"p"},"-m")," flag to include a fee of 0.000275 TXCH."),(0,l.kt)("admonition",{type:"info"},(0,l.kt)("p",{parentName:"admonition"},"The testnet is constantly being dusted (filled with small transactions) in order to simulate a busy network. Because of this you are always recommended to include a fee with testnet transactions. The 275-million mojo fee from this demo should be sufficient to push your transactions through in the next transaction block."),(0,l.kt)("p",{parentName:"admonition"},"If you are running on mainnet, a fee of 275 million mojos is likely higher than the recommended amount. The reference wallet GUI will suggest an appropriate fee to be included with all transactions.")),(0,l.kt)("p",null,"The Sender will run the following command in this example (once again, these are only example settings; replace the values as needed):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback create -t txch1czxl4c42kwem8jllm4xp78jt7t0j0pu9uh9xw5jddegcu703xnpsqaaxxx -a 0.1 -l 600 -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Created Coin with ID: 29056b320b380c0fc4834578ca30318ae9c1d1cddbe39a91197870c4dc474532\nCoin { parent_coin_info: dcedd4d573679302ee3f2a54fb51c437b8156e8cd5b1c3c08d25cadf83292c3d, puzzle_hash: 13cb7ce11775a5b42754fb382eb94c846e4be677e6d55bf665b23c075a54e930, amount: 100000000000 }\n")),(0,l.kt)("p",null,"As a result of running this command, a new clawback coin has been created on the blockchain, the details of which are shown above. To view this coin, along with other clawback coins created by this wallet, run the ",(0,l.kt)("a",{parentName:"p",href:"/clawback_cli#show"},"clawback show")," command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"The basic details of the clawback coin are given:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\nUpdating coin records...\n\n\nCoin ID: 29056b320b380c0fc4834578ca30318ae9c1d1cddbe39a91197870c4dc474532\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 600 seconds\nTime left: 518 seconds\n")),(0,l.kt)("h3",{id:"claw-back-a-coin"},"Claw back a coin"),(0,l.kt)("p",null,"This guide will continue from the previous section, where we created a new clawback coin, which has not yet been spent. As a reminder, these are the clawback coin's details:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: 29056b320b380c0fc4834578ca30318ae9c1d1cddbe39a91197870c4dc474532\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 600 seconds\nTime left: 518 seconds\n")),(0,l.kt)("p",null,"The same public/private key pair that created this coin must be used to claw it back."),(0,l.kt)("p",null,"The Sender will use the ",(0,l.kt)("a",{parentName:"p",href:"/clawback_cli#claw"},"clawback claw")," command, passing in the ID of the coin to claw back:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claw -c 29056b320b380c0fc4834578ca30318ae9c1d1cddbe39a91197870c4dc474532 -m 0.000275\n")),(0,l.kt)("p",null,"As a result, the clawback coin will be spent:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Submitted spend to claw back coin: 29056b320b380c0fc4834578ca30318ae9c1d1cddbe39a91197870c4dc474532\n")),(0,l.kt)("p",null,"To show the status of the clawback, run the ",(0,l.kt)("inlineCode",{parentName:"p"},"clawback show")," command once again:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\nNo coins found\n")),(0,l.kt)("p",null,"After the clawback transaction has completed, the Sender wallet's balance has increased (minus transaction fees):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 3807629793\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 3807629793\nWallet height: 2405004\nSync status: Synced\nBalances, fingerprint: 3807629793\n\nChia Wallet:\n   -Total Balance:         7.99945 txch (7999450000000 mojo)\n   -Pending Total Balance: 7.99945 txch (7999450000000 mojo)\n   -Spendable:             7.99945 txch (7999450000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"At this point, the clawback coin no longer exists. The Sender is of course free to create new clawback coins as they see fit."),(0,l.kt)("h3",{id:"claim-a-clawback-coin"},"Claim a clawback coin"),(0,l.kt)("p",null,"In this section, we'll show how to claim a clawback coin. First, the Sender creates a new clawback coin with a 60-second timelock:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback create -t txch1czxl4c42kwem8jllm4xp78jt7t0j0pu9uh9xw5jddegcu703xnpsqaaxxx -a 0.1 -l 60 -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Created Coin with ID: ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\nCoin { parent_coin_info: f5e408a15299df27a00d0403ea50ed29a06f87a31b638cff1b63ef3e6060b45a, puzzle_hash: 2e91566d9549cb909109d147c79b457d15ced2d8a24dea5a125b1e5c05cdd1ec, amount: 100000000000 }\n")),(0,l.kt)("p",null,"The Sender can run the ",(0,l.kt)("inlineCode",{parentName:"p"},"clawback show")," command to show the details of each of their clawback coins:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 60 seconds\nTime left: 23 seconds\n")),(0,l.kt)("p",null,"The timelock expires when the ",(0,l.kt)("inlineCode",{parentName:"p"},"Time left:")," value reaches ",(0,l.kt)("inlineCode",{parentName:"p"},"0 seconds"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 60 seconds\nTime left: 0 seconds\n")),(0,l.kt)("p",null,"For your reference, the Recipient wallet currently has a balance of 0 XCH:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 1231588123\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2405060\nSync status: Synced\nBalances, fingerprint: 1231588123\n\nChia Wallet:\n   -Total Balance:         0.0 txch (0 mojo)\n   -Pending Total Balance: 0.0 txch (0 mojo)\n   -Spendable:             0.0 txch (0 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"The Recipient (or anyone else) can view the status of the clawback coin if they know the coin ID:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show -c ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 60 seconds\nTime left: 0 seconds\n")),(0,l.kt)("p",null,"The value of ",(0,l.kt)("inlineCode",{parentName:"p"},"Time left:")," is ",(0,l.kt)("inlineCode",{parentName:"p"},"0 seconds"),". In most cases (see the info box below for more info), the Recipient can now run the ",(0,l.kt)("a",{parentName:"p",href:"/clawback_cli#claim"},"clawback claim")," command to claim the coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claim -c ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Submitted spend to claim coin: ef4b69e65e99261d6e30c8d2d331a8ed84995f3452b95aaa944f76a0f9af74c5\n")),(0,l.kt)("admonition",{type:"info"},(0,l.kt)("p",{parentName:"admonition"},"In most cases, if the output of the ",(0,l.kt)("inlineCode",{parentName:"p"},"clawback show")," command contains ",(0,l.kt)("inlineCode",{parentName:"p"},"Time left: 0 seconds"),", this indicates that the Recipient can proceed with the ",(0,l.kt)("inlineCode",{parentName:"p"},"claim")," call."),(0,l.kt)("p",{parentName:"admonition"},"However, there is a small window of time where the timer has expired, but a block still hasn't been farmed with a timestamp after the expiry. If the Recipient attempts to make the ",(0,l.kt)("inlineCode",{parentName:"p"},"claim")," call during this window, they will receive the following error:"),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("inlineCode",{parentName:"p"},"You are trying to claim the coin too early")),(0,l.kt)("p",{parentName:"admonition"},"In this case, the Recipient needs to wait for one more block to be farmed before proceeding with the ",(0,l.kt)("inlineCode",{parentName:"p"},"claim")," call. As a reminder, a new block is farmed every 18.75 seconds, on average.")),(0,l.kt)("p",null,"While the ",(0,l.kt)("inlineCode",{parentName:"p"},"claim")," transaction is being processed, it will show in the ",(0,l.kt)("inlineCode",{parentName:"p"},"Pending Total Balance:")," of the Recipient's wallet:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 1231588123\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2405100\nSync status: Synced\nBalances, fingerprint: 1231588123\n\nChia Wallet:\n   -Total Balance:         0.0 txch (0 mojo)\n   -Pending Total Balance: 0.1 txch (100000000000 mojo)\n   -Spendable:             0.0 txch (0 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"Finally, the Recipient can view the additional balance in their wallet:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 1231588123\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Wallet height: 2405465\nSync status: Synced\nBalances, fingerprint: 1231588123\n\nChia Wallet:\n   -Total Balance:         0.1 txch (100000000000 mojo)\n   -Pending Total Balance: 0.1 txch (100000000000 mojo)\n   -Spendable:             0.1 txch (100000000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"The spend is now complete and can no longer be clawed back. The funds are stored as a standard Chia coin in the Recipient's wallet."),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"other-cases"},"Other cases"),(0,l.kt)("p",null,"So far, we have shown the standard clawback and completion spends. There are also a few edge cases and errors worth discussing."),(0,l.kt)("h4",{id:"sender-performs-a-clawback-after-the-timelock"},"Sender performs a clawback after the timelock"),(0,l.kt)("p",null,"After the timelock expires, the Recipient may claim the clawback coin. Until this is done, the Sender can still claw back the coin. "),(0,l.kt)("p",null,"Let's say the Sender's wallet contains 7.899175 TXCH:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 3807629793\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2405202\nSync status: Synced\nBalances, fingerprint: 3807629793\n\nChia Wallet:\n   -Total Balance:         7.899175 txch (7899175000000 mojo)\n   -Pending Total Balance: 7.899175 txch (7899175000000 mojo)\n   -Spendable:             7.899175 txch (7899175000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"The Sender creates a new clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback create -t txch1czxl4c42kwem8jllm4xp78jt7t0j0pu9uh9xw5jddegcu703xnpsqaaxxx -a 0.1 -l 60 -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Created Coin with ID: 5024cdd687a70d8a1340e774a9e29c3dc2aa1e3726eaae40700f2859db5fdd1e\nCoin { parent_coin_info: b07dbf3274bfdb49d5082fac741c4f26bf7cf5ca5382dc27234e7602b9bf66ce, puzzle_hash: f0f6294fbc4cf903694000b18764c05a4530b340a783f85dbdb2ef60c29873bb, amount: 100000000000 }\n")),(0,l.kt)("p",null,"The Sender waits waits for the clawback's timelock to expire:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Coin ID: 5024cdd687a70d8a1340e774a9e29c3dc2aa1e3726eaae40700f2859db5fdd1e\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 60 seconds\nTime left: 0 seconds\n")),(0,l.kt)("p",null,"At this point, the Recipient could claim this coin. However, the Sender also can claw back this coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claw -c \n")),(0,l.kt)("p",null,"Result: 5024cdd687a70d8a1340e774a9e29c3dc2aa1e3726eaae40700f2859db5fdd1e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Submitted spend to claw back coin: 5024cdd687a70d8a1340e774a9e29c3dc2aa1e3726eaae40700f2859db5fdd1e\n")),(0,l.kt)("p",null,"After the transaction completes, the clawback coin has been returned to the Sender's wallet. The Sender's balance matches the original balance, minus any transaction fees:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 3807629793\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2405553\nSync status: Synced\nBalances, fingerprint: 3807629793\n\nChia Wallet:\n   -Total Balance:         7.8989 txch (7898900000000 mojo)\n   -Pending Total Balance: 7.8989 txch (7898900000000 mojo)\n   -Spendable:             7.8989 txch (7898900000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("p",null,"Because the Sender can always claw back a clawback coin while it exists, the Recipient cannot assume that they will receive the clawback coin, even after the timelock has expired. However, after the Recipient has claimed the clawback coin and it has appeared in the Recipient's wallet as regular XCH/TXCH, the coin can no longer be clawed back."),(0,l.kt)("h4",{id:"recipient-attempts-to-claim-clawback-coin-before-timelock-has-expired"},"Recipient attempts to claim clawback coin before timelock has expired"),(0,l.kt)("p",null,"Before the timelock expires, a clawback coin may not be spent to its Recipient's address. For example, let's say the following clawback coin exists. Note that its ",(0,l.kt)("inlineCode",{parentName:"p"},"Time left:")," is still greater than 0 seconds:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show -c 8aec68811dfa272e1655eb75c93de5011d9f1efb7d4ad81c610d0045055f8b8f\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: 8aec68811dfa272e1655eb75c93de5011d9f1efb7d4ad81c610d0045055f8b8f\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 600 seconds\nTime left: 529 seconds\n")),(0,l.kt)("p",null,"At this point, if the Recipient attempts to claim the clawback coin, it will not succeed:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claim -c 8aec68811dfa272e1655eb75c93de5011d9f1efb7d4ad81c610d0045055f8b8f -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"You are trying to claim the coin too early\n")),(0,l.kt)("h4",{id:"someone-other-than-the-sender-attempts-to-claw-back-a-coin"},"Someone other than the Sender attempts to claw back a coin"),(0,l.kt)("p",null,"For this example, the Sender creates a new clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback create -t txch1czxl4c42kwem8jllm4xp78jt7t0j0pu9uh9xw5jddegcu703xnpsqaaxxx -a 1 -l 300 -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Created Coin with ID: cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb\nCoin { parent_coin_info: 73efa5832a6d639871b7170dca86c97c1b79610a9f826d0533026d2d655e80ae, puzzle_hash: efa2dbe8f4634952518037fd1daeb3d38771a41e1ddb81657cc8d803b31c7512, amount: 1000000000000 }\n")),(0,l.kt)("p",null,"A different wallet (it could be the Recipient, or any other wallet) is unable to view the clawback without knowing the Coin ID:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\nUpdating coin records...\nNo coins found\n")),(0,l.kt)("p",null,"However, if the owner of the non-Sender wallet knows the Coin ID, they ",(0,l.kt)("em",{parentName:"p"},"can")," view the clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show -c cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb\nAmount: 1 XCH (1000000000000 mojos)\nTimelock: 300 seconds\nTime left: 131 seconds\n")),(0,l.kt)("p",null,"If the non-Sender wallet attempts to claw the coin back, then this will fail:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claw -c cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'Traceback (most recent call last):\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\runpy.py", line 197, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\runpy.py", line 87, in _run_code\n    exec(code, run_globals)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\Scripts\\clawback.exe\\__main__.py", line 7, in <module>\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 449, in main\n    asyncio.run(cli())  # pylint: disable=no-value-for-parameter\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1130, in __call__\n    return self.main(*args, **kwargs)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1055, in main\n    rv = self.invoke(ctx)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1404, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 760, in invoke\n    return __callback(*args, **kwargs)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 348, in claw_cmd\n    asyncio.get_event_loop().run_until_complete(do_command(fee, wallet_id, target_address, fingerprint))\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\asyncio\\base_events.py", line 642, in run_until_complete\n    return future.result()\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 317, in do_command\n    spend = await manager.create_clawback_spend(cb_info, target_ph, fee)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\drivers\\cb_manager.py", line 195, in create_clawback_spend\n    inner_puzzle = await self.get_puzzle_for_puzzle_hash(cb_info.sender_ph)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\drivers\\cb_manager.py", line 85, in get_puzzle_for_puzzle_hash\n    private_key, _, _ = await self.get_keys_for_puzzle_hash(puzzle_hash)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\drivers\\cb_manager.py", line 82, in get_keys_for_puzzle_hash\n    raise ValueError(f"Couldn\'t find a matching key for puzzle hash: {puzzle_hash}.")\nValueError: Couldn\'t find a matching key for puzzle hash: ee3144040e80747af2f6ec56ed7567d22ca83ea3470e09bb9d95347a80cd2d29.\n')),(0,l.kt)("h4",{id:"someone-other-than-the-recipient-attempts-to-claim-a-clawback-spend"},"Someone other than the Recipient attempts to claim a clawback spend"),(0,l.kt)("p",null,"For this example, someone other than the Recipient is made aware of the Coin ID of a pending clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show -c cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb\nAmount: 1 XCH (1000000000000 mojos)\nTimelock: 300 seconds\nTime left: 0 seconds\n")),(0,l.kt)("p",null,"Only the Recipient may attempt to claim a clawback spend. If another wallet (it could be the Sender, or any other wallet) attempts this, the claim will fail:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claim -c cb11caa0f4d02b08b94e949e34105b7f5cd4f6918fd65c92beeeded6aea1f8eb -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'Traceback (most recent call last):\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\runpy.py", line 197, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\runpy.py", line 87, in _run_code\n    exec(code, run_globals)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\Scripts\\clawback.exe\\__main__.py", line 7, in <module>\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 449, in main\n    asyncio.run(cli())  # pylint: disable=no-value-for-parameter\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1130, in __call__\n    return self.main(*args, **kwargs)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1055, in main\n    rv = self.invoke(ctx)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1404, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 760, in invoke\n    return __callback(*args, **kwargs)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 444, in claim_cmd\n    asyncio.get_event_loop().run_until_complete(do_command(fee, wallet_id, target_address, fingerprint))\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\asyncio\\base_events.py", line 642, in run_until_complete\n    return future.result()\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 413, in do_command\n    spend = await manager.create_claim_spend(coin_record.coin, target_ph, fee)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\drivers\\cb_manager.py", line 242, in create_claim_spend\n    inner_puzzle = await self.get_puzzle_for_puzzle_hash(recipient_ph)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\drivers\\cb_manager.py", line 85, in get_puzzle_for_puzzle_hash\n    private_key, _, _ = await self.get_keys_for_puzzle_hash(puzzle_hash)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\drivers\\cb_manager.py", line 82, in get_keys_for_puzzle_hash\n    raise ValueError(f"Couldn\'t find a matching key for puzzle hash: {puzzle_hash}.")\nValueError: Couldn\'t find a matching key for puzzle hash: c08dfae2aab3b3b3cbffdd4c1f1e4bf2df278785e5ca67524d6e518e79f134c3.\n')),(0,l.kt)("h4",{id:"sender-claws-back-coin-to-a-new-wallet"},"Sender claws back coin to a new wallet"),(0,l.kt)("p",null,"The Sender has the option of performing a clawback where the coin is sent to any wallet. Let's say the Sender creates a clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback create -t txch1czxl4c42kwem8jllm4xp78jt7t0j0pu9uh9xw5jddegcu703xnpsqaaxxx -a 0.1 -l 60 -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Created Coin with ID: 73e062705a7b44ffc92e7e79dcae8b365363fb2f7d0cf2e983905544f99a6a47\nCoin { parent_coin_info: 175def0bab89a08a091af7ab02fe71523437c636dd3f746b49243915ffed4d74, puzzle_hash: 4975c4c0de463699efd07a376aebb0f81454ee406c0d5492c67aa3ee9c928ff3, amount: 100000000000 }\n")),(0,l.kt)("p",null,"The Sender can then claw back the coin to a new wallet address:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claw -c 73e062705a7b44ffc92e7e79dcae8b365363fb2f7d0cf2e983905544f99a6a47 -m 0.000275 -t txch13alcyq2x9px5mhcvalhq4jj9g9n8asz6ud8htmguwejrl6j722cq4ahxkw\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Submitted spend to claw back coin: 73e062705a7b44ffc92e7e79dcae8b365363fb2f7d0cf2e983905544f99a6a47\n")),(0,l.kt)("p",null,"Note that the wallet address specified in the ",(0,l.kt)("inlineCode",{parentName:"p"},"claw")," command does not need to be associated with the Sender's wallet.\nIn this case, the address belongs to a separate wallet. After the clawback completes, the new wallet has received the clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f 1010362042\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2405908\nSync status: Synced\nBalances, fingerprint: 1010362042\n\nChia Wallet:\n   -Total Balance:         0.1 txch (100000000000 mojo)\n   -Pending Total Balance: 0.1 txch (100000000000 mojo)\n   -Spendable:             0.1 txch (100000000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("h4",{id:"recipient-claims-a-clawback-coin-in-a-new-wallet-address"},"Recipient claims a clawback coin in a new wallet address"),(0,l.kt)("p",null,"The Recipient also has the option of spending a clawback coin to a new address."),(0,l.kt)("p",null,"Let's say the Sender creates the following clawback coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback create -t txch1czxl4c42kwem8jllm4xp78jt7t0j0pu9uh9xw5jddegcu703xnpsqaaxxx -a 0.1 -l 60 -m 0.000275\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Created Coin with ID: fddcfe2a4fcb7705646c809993a762664c1b0442b74d14d1298d91a3a198975b\nCoin { parent_coin_info: 478f112fe50a5680ccd4617ff9ba00edffb0aa59e72cf77742af4037f17ee38f, puzzle_hash: bbaa15db9dd52f8c5f27ce4bbb26776b11690cd1f0bc3cebd5d77ab118c680b2, amount: 100000000000 }\n")),(0,l.kt)("p",null,"After the timelock expires, the Recipient verifies that the coin can be claimed:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show -c fddcfe2a4fcb7705646c809993a762664c1b0442b74d14d1298d91a3a198975b\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: fddcfe2a4fcb7705646c809993a762664c1b0442b74d14d1298d91a3a198975b\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 60 seconds\nTime left: 0 seconds\n")),(0,l.kt)("p",null,"The Recipient can pass in a new address when claiming the coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback claim -c fddcfe2a4fcb7705646c809993a762664c1b0442b74d14d1298d91a3a198975b -m 0.000275 -t txch12adzcdatddls80qnpnlnp3mn3tu0rvjwgs9yeyfg8vr2agremjpsp74p0c\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Submitted spend to claim coin: fddcfe2a4fcb7705646c809993a762664c1b0442b74d14d1298d91a3a198975b\n")),(0,l.kt)("p",null,"Note that the wallet address does not need to belong to the Recipient's wallet. In this case, the address belongs to a totally separate wallet."),(0,l.kt)("p",null,"After the ",(0,l.kt)("inlineCode",{parentName:"p"},"claim")," transaction has completed, the clawback coin will show up as a standard Chia coin in the alternative wallet:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"chia wallet show -f  4215889205\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Wallet height: 2405955\nSync status: Synced\nBalances, fingerprint: 4215889205\n\nChia Wallet:\n   -Total Balance:         0.1 txch (100000000000 mojo)\n   -Pending Total Balance: 0.1 txch (100000000000 mojo)\n   -Spendable:             0.1 txch (100000000000 mojo)\n   -Type:                  STANDARD_WALLET\n   -Wallet ID:             1\n")),(0,l.kt)("h4",{id:"sender-or-recipient-attempts-to-show-a-clawback-coin-before-it-has-been-created"},"Sender or Recipient attempts to show a clawback coin before it has been created"),(0,l.kt)("p",null,"Two important rules to keep in mind:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"A clawback coin's creation requires an on-chain transaction"),(0,l.kt)("li",{parentName:"ol"},"On Chia's blockchain, the average time between transaction blocks is 52 seconds")),(0,l.kt)("p",null,"Whenever a Sender creates a clawback coin, there is a period where the transaction is pending. During this period, it is not possible to view the exact details of the clawback coin."),(0,l.kt)("p",null,"If the Sender attempts to view the coin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Time left:")," value will be listed as ",(0,l.kt)("inlineCode",{parentName:"p"},"pending"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"Updating coin records...\n\n\nCoin ID: 4fc6be4bd086e2b0600aab0075b67a6dada1a0bb8041d7206e9744c1d3810ec8\nAmount: 0.1 XCH (100000000000 mojos)\nTimelock: 600 seconds\nTime left: pending\n")),(0,l.kt)("p",null,"If someone other than the Sender wants to view the coin, they will need to pass in the Coin ID (the Sender could also do this and get the same result):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clawback show -c 4fc6be4bd086e2b0600aab0075b67a6dada1a0bb8041d7206e9744c1d3810ec8\n")),(0,l.kt)("p",null,"In this case, an error will be thrown:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'Updating coin records...\nTraceback (most recent call last):\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\runpy.py", line 197, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\runpy.py", line 87, in _run_code\n    exec(code, run_globals)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\Scripts\\clawback.exe\\__main__.py", line 7, in <module>\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 444, in main\n    asyncio.run(cli())  # pylint: disable=no-value-for-parameter\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1130, in __call__\n    return self.main(*args, **kwargs)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1055, in main\n    rv = self.invoke(ctx)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1657, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 1404, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\click\\core.py", line 760, in invoke\n    return __callback(*args, **kwargs)\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 254, in show_cmd\n    asyncio.get_event_loop().run_until_complete(do_command(coin_id, fingerprint))\n  File "C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python39\\lib\\asyncio\\base_events.py", line 642, in run_until_complete\n    return future.result()\n  File "C:\\Users\\User\\Chia\\clawback\\chia-clawback-primitive\\venv\\lib\\site-packages\\src\\cli\\main.py", line 230, in do_command\n    block = await node_client.get_block_record_by_height(record.confirmed_block_height)\nAttributeError: \'NoneType\' object has no attribute \'confirmed_block_height\'\n')))}m.isMDXComponent=!0}}]);