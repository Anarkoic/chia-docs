"use strict";(self.webpackChunkchia_docs=self.webpackChunkchia_docs||[]).push([[981],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=d(n),h=i,m=p["".concat(s,".").concat(h)]||p[h]||c[h]||o;return n?a.createElement(m,r(r({ref:t},u),{},{components:n})):a.createElement(m,r({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:i,r[1]=l;for(var d=2;d<o;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},6694:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=n(7462),i=(n(7294),n(3905));const o={title:"Seeder User Guide",slug:"/guides/seeder-user-guide"},r="Seeder User Guide",l={unversionedId:"guides/seeder-user-guide",id:"guides/seeder-user-guide",title:"Seeder User Guide",description:"The Chia Seeder & Crawler is a tool to keep track of the most reliable nodes on the Chia network. Each instance of the Chia Seeder maintains its own separate list of IP addresses of these nodes.",source:"@site/docs/guides/seeder-user-guide.md",sourceDirName:"guides",slug:"/guides/seeder-user-guide",permalink:"/zh/guides/seeder-user-guide",draft:!1,editUrl:"https://github.com/Chia-Network/chia-docs/blob/main/docs/guides/seeder-user-guide.md",tags:[],version:"current",frontMatter:{title:"Seeder User Guide",slug:"/guides/seeder-user-guide"},sidebar:"guides",previous:{title:"Simulator User Guide",permalink:"/zh/guides/simulator-user-guide"},next:{title:"Verifiable Credentials Guide",permalink:"/zh/guides/verifiable-credentials-guide"}},s={},d=[{value:"Expectations for Chia Seeder operators",id:"expectations-for-chia-seeder-operators",level:2},{value:"Installation",id:"installation",level:2},{value:"Special instructions on Ubuntu",id:"special-instructions-on-ubuntu",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Running",id:"running",level:2},{value:"Testing",id:"testing",level:2},{value:"Stopping",id:"stopping",level:2},{value:"Being included in config.yaml",id:"being-included-in-configyaml",level:2}],u={toc:d},p="wrapper";function c(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"seeder-user-guide"},"Seeder User Guide"),(0,i.kt)("p",null,"The Chia Seeder & Crawler is a tool to keep track of the most reliable nodes on the Chia network. Each instance of the Chia Seeder maintains its own separate list of IP addresses of these nodes."),(0,i.kt)("p",null,"It does so by crawling through the network, periodically revisiting known nodes from its list. If a node is either no longer available, or has exhibited untoward behavior, the Chia Seeder instance removes that node from its list."),(0,i.kt)("p",null,"The Chia Seeder runs a mini-DNS server. Anyone can obtain an entry point into Chia\u2019s decentralized and permissionless network via a simple DNS request for reliable node IPs. "),(0,i.kt)("p",null,"The Chia Seeder has very low memory and CPU requirements. "),(0,i.kt)("p",null,"Chia\u2019s core developers have already been running an instance of the Chia Seeder for some time. You can view the current status of this instance by running:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# IPv4\ndig dns-introducer.chia.net\n\n# IPv6\ndig -t AAAA dns-introducer.chia.net\n")),(0,i.kt)("p",null,"Chia has now decided to release the Seeder as a tool for anyone to maintain their own list of reliable nodes, which contributes to the further decentralization of Chia\u2019s network by taking this tool off of the core team\u2019s hands."),(0,i.kt)("p",null,"Features:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Implements peer statistics and exponentially moving averages over various time-windows, akin to those maintained by its relative, the bitcoin-seeder: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/sipa/bitcoin-seeder"},"https://github.com/sipa/bitcoin-seeder")),(0,i.kt)("li",{parentName:"ul"},"Runs a mini-DNS server on port 53, along with a full node to crawl the network."),(0,i.kt)("li",{parentName:"ul"},"Stores peer IPs and peer statistics into a database, so that they are persisted across runs.")),(0,i.kt)("h2",{id:"expectations-for-chia-seeder-operators"},"Expectations for Chia Seeder operators"),(0,i.kt)("p",null,"The Chia network core developers endeavor to minimize the level of trust in the DNS servers associated with a Chia Seeder. In this regard, it is expected for each Chia Seeder to be run by an individual or organization recognized as well-intentioned within the Chia community."),(0,i.kt)("p",null,"This entails following good host security practices, maintaining control of the underlying infrastructure, and not transferring control of the Chia Seeder they operate."),(0,i.kt)("p",null,"Logging of DNS queries must not be retained longer than necessary (as might be required for the operation of the service), and must not be communicated to any third-party."),(0,i.kt)("p",null,"Each entity maintaining a Chia Seeder DNS server is encouraged to make publicly available the details of their operating practices."),(0,i.kt)("p",null,"In keeping with all the previous recommendations, a reachable email address or Keybase account must be published for inquiries regarding said operating practices."),(0,i.kt)("p",null,"There are additional operation considerations for inclusion in the ",(0,i.kt)("inlineCode",{parentName:"p"},"initial-config.yaml")," outlined below."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sh install.sh\n$ . ./activate\n$ chia init\n")),(0,i.kt)("p",null,"You most certainly will want to specify your own configuration of a domain name server. Do so by editing the config file located at ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.chia/mainnet/config/config.yaml"),", or by running ",(0,i.kt)("inlineCode",{parentName:"p"},"chia configure"),". Please refer to the relevant section below for more details, or enter ",(0,i.kt)("inlineCode",{parentName:"p"},"$ chia configure --help"),"."),(0,i.kt)("h2",{id:"special-instructions-on-ubuntu"},"Special instructions on Ubuntu"),(0,i.kt)("p",null,"On Ubuntu, it is possible that systemd-resolved already binds port 53. The Chia Seeder's built-in DNS server is run on the same port, and systemd-resolved takes precedence by default. "),(0,i.kt)("p",null,"Special instructions to free port 53 are provided here (points #2 and #3): ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/team-exor/generic-seeder#exclamation-special-instructions-for-ubuntu-users-exclamation"},"https://github.com/team-exor/generic-seeder#exclamation-special-instructions-for-ubuntu-users-exclamation")),(0,i.kt)("p",null,"This amounts to editing ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/systemd/resolved.conf")," so as to disable binding of systemd-resolved to port 53 by setting ",(0,i.kt)("inlineCode",{parentName:"p"},"DNSStubListener=no"),", or, alternatively, entirely disabling the systemd-resolved service. Note that you will likely need to add a nameserver in '/etc/resolv.conf'."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Example resolv.conf\nnameserver 2001:4860:4860::8888\nnameserver 2001:4860:4860::8844\nnameserver 8.8.8.8\nnameserver 8.8.4.4\n")),(0,i.kt)("p",null,"Once you have completed freeing up port 53, you will then need to allow the python executable in your venv to have access to port 53:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo setcap CAP_NET_BIND_SERVICE=+eip $(readlink -f /home/{{ user }}/chia-blockchain/venv/bin/python)\n")),(0,i.kt)("p",null,"Note that anytime you change the python executable by rerunning ",(0,i.kt)("inlineCode",{parentName:"p"},"sh install.sh")," or when ",(0,i.kt)("inlineCode",{parentName:"p"},"apt")," upgrades python, you will need to re-run this command."),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"The config file is ",(0,i.kt)("inlineCode",{parentName:"p"},".chia/mainnet/config/config.yaml")," The default values are for running a DNS seeder for mainnet. At the very least, in the ",(0,i.kt)("inlineCode",{parentName:"p"},"seeder:")," section of config.yaml, the variables ",(0,i.kt)("inlineCode",{parentName:"p"},"domain_name"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"nameserver")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"soa")," need to be changed to reflect the NS entry for your server in a domain record. "),(0,i.kt)("p",null,"For a local DNS server setup, you will need control of a top-level domain (TLD) allowing administrator access for the purpose of creating additional DNS entries. Any domain registrar should be fine to use. "),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Note that while it may be possible to use an existing domain, it is recommended to register a new domain name to specifically run the Chia Seeder address.")),(0,i.kt)("p",null,'Proceed by logging into your domain registrar and navigating to the section pertaining to managing DNS records for your domain. Next, click or activate the button or mechanism for creating a new DNS record. Finally, create a new DNS record of type "A", along with another new DNS record of type "NS".'),(0,i.kt)("p",null,"For instance, if you want to run a Chia Seeder's DNS server on ",(0,i.kt)("inlineCode",{parentName:"p"},"my-chia-seeder.example.com"),", an authoritative NS record in ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),"'s domain record will be required, which might point, e.g., to ",(0,i.kt)("inlineCode",{parentName:"p"},"vps.example.com"),". "),(0,i.kt)("p",null,"You can check that this is the case by running the following command (please ensure that you have ",(0,i.kt)("inlineCode",{parentName:"p"},"dig")," on your system by installing the ",(0,i.kt)("inlineCode",{parentName:"p"},"dnsutils")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"bind9-dnsutils")," package; for instance, on Ubuntu, ",(0,i.kt)("inlineCode",{parentName:"p"},"$ sudo apt install dnsutils")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"$ sudo apt install bind9-dnsutils"),"):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ dig -t NS my-chia-seeder.example.com\n")),(0,i.kt)("p",null,"whose output should display, among other information, the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},";; ANSWER SECTION\nmy-chia-seeder.example.com.    86400    IN    NS    vps.example.com\n")),(0,i.kt)("p",null,'For another example on how to set-up "A" and "NS" records for your domain using DigitalOcean, please refer to the following video, from 9:40 onward: ',(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=DsaxbwwVEXk&t=580s"},"https://www.youtube.com/watch?v=DsaxbwwVEXk&t=580s")),(0,i.kt)("p",null,"For AWS Route 53 - in the hosted zone you want to use e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),' add a "NS"/nameserver record with the ',(0,i.kt)("inlineCode",{parentName:"p"},"Record name")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"my-chia-seeder")," and a value of ",(0,i.kt)("inlineCode",{parentName:"p"},"vps.example.com"),". As of January 2023, the Route 53 web user interface requires you first enter text into the ",(0,i.kt)("inlineCode",{parentName:"p"},"Record name")," field as the Record type of MX will otherwise be greyed out in the pulldown. Then you will create both an A and a AAAA record for ",(0,i.kt)("inlineCode",{parentName:"p"},"vps.example.com")," that corresponds to your vps's IP addresses."),(0,i.kt)("p",null,"In ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yaml")," the ",(0,i.kt)("inlineCode",{parentName:"p"},"domain_name")," is ",(0,i.kt)("inlineCode",{parentName:"p"},"my-chia-seeder.example.com.")," and the ",(0,i.kt)("inlineCode",{parentName:"p"},"nameserver")," is ",(0,i.kt)("inlineCode",{parentName:"p"},"vps.example.com."),". Note the trailing periods. The main thing to change in ",(0,i.kt)("inlineCode",{parentName:"p"},"soa")," is adding a correct contact email in ",(0,i.kt)("inlineCode",{parentName:"p"},"rname")," and optionally changing the ",(0,i.kt)("inlineCode",{parentName:"p"},"serial_number"),"."),(0,i.kt)("h2",{id:"running"},"Running"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ . ./activate\n$ chia start seeder\n")),(0,i.kt)("p",null,"will run both a crawler and a DNS server.\nAlternatively,"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ . ./activate\n$ chia start crawler\n")),(0,i.kt)("p",null,"gives you the option to merely crawl the network so as to get a list of the connectable nodes, without having to set up a DNS server."),(0,i.kt)("h2",{id:"testing"},"Testing"),(0,i.kt)("p",null,"You should test to make sure that the Chia node can connect. "),(0,i.kt)("p",null,"On a version of chia-blockchain newer than 1.6.2, stop node then delete ",(0,i.kt)("inlineCode",{parentName:"p"},"peers.dat")," in ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.chia/mainnet/db/"),". "),(0,i.kt)("p",null,"Modify your ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yaml")," to include only your dns seeder. "),(0,i.kt)("p",null,"If you tail the logs as you start up the node you should see the node connect and obtain both IPv4 and IPv6 nodes. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"2023-01-14T15:19:30.969 full_node chia.full_node.full_node: INFO     Received 32 peers from DNS seeder, using rdtype = A.\n2023-01-14T15:19:31.010 full_node chia.full_node.full_node: INFO     Received 32 peers from DNS seeder, using rdtype = AAAA.\n")),(0,i.kt)("p",null,"Sometimes dns takes a moment so seeing some initial flakiness here is not cause for concern. Just stop again, delete ",(0,i.kt)("inlineCode",{parentName:"p"},"peers.dat")," and try the test again."),(0,i.kt)("h2",{id:"stopping"},"Stopping"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ . ./activate\n$ chia stop -d all\n")),(0,i.kt)("h2",{id:"being-included-in-configyaml"},"Being included in config.yaml"),(0,i.kt)("p",null,"There are a couple of criteria we all look for when adding a seeder to the initial config file."),(0,i.kt)("p",null,"You must have an ICANN registered domain name. Your seeder host must support IPv6 and IPv4."),(0,i.kt)("p",null,"We ask that you commit to a monthly uptime of 99.9% which is available enough to be reliable but also leaves flexibility to not need to run a cluster and gives you time for a reboot once in a while to keep up with things like security patches. We will be monitoring all of the seeders listed in the most recent version of ",(0,i.kt)("inlineCode",{parentName:"p"},"initial-config.yaml"),". We highly recommend that you enable monitoring of your seeder as well. We are heavy users of ",(0,i.kt)("a",{parentName:"p",href:"https://uptimerobot.com/"},"Uptime Robot")," but anything similar will do."),(0,i.kt)("p",null,"Being a known community member - the better you're known (pseudonymously is fine) - the more likely you are to be added. You should have an account on ",(0,i.kt)("a",{parentName:"p",href:"https://keybase.io/"},"Keybase")," and we will need to know your Keybase handle, as you will be added to a seeder operator's private channel."),(0,i.kt)("p",null,"The final criteria is geographical dispersion. If you are hosting in a region where we don't have a seeder, you are more likely to be added. We will want to know what country (and region if it's a large country e.g. North West US) - generally - your seeder will reside in to facilitate this."),(0,i.kt)("p",null,"The easiest way to propose being added is to open a pull request for ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/util/initial-config.yaml"},"initial-config.yaml")," and include the information required from the four points above."))}c.isMDXComponent=!0}}]);