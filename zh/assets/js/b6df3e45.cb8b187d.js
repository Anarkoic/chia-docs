"use strict";(self.webpackChunkchia_docs=self.webpackChunkchia_docs||[]).push([[558],{3905:(e,a,t)=>{t.d(a,{Zo:()=>f,kt:()=>m});var n=t(7294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=n.createContext({}),d=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},f=function(e){var a=d(e.components);return n.createElement(s.Provider,{value:a},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},p=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,f=i(e,["components","mdxType","originalType","parentName"]),u=d(t),p=r,m=u["".concat(s,".").concat(p)]||u[p]||c[p]||l;return t?n.createElement(m,o(o({ref:a},f),{},{components:t})):n.createElement(m,o({ref:a},f))}));function m(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=p;var i={};for(var s in a)hasOwnProperty.call(a,s)&&(i[s]=a[s]);i.originalType=e,i[u]="string"==typeof e?e:r,o[1]=i;for(var d=2;d<l;d++)o[d]=t[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}p.displayName="MDXCreateElement"},5162:(e,a,t)=>{t.d(a,{Z:()=>o});var n=t(7294),r=t(6010);const l={tabItem:"tabItem_Ymn6"};function o(e){let{children:a,hidden:t,className:o}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(l.tabItem,o),hidden:t},a)}},4866:(e,a,t)=>{t.d(a,{Z:()=>w});var n=t(7462),r=t(7294),l=t(6010),o=t(2466),i=t(6550),s=t(1980),d=t(7392),f=t(12);function u(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:r}}=e;return{value:a,label:t,attributes:n,default:r}}))}function c(e){const{values:a,children:t}=e;return(0,r.useMemo)((()=>{const e=a??u(t);return function(e){const a=(0,d.l)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function p(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function m(e){let{queryString:a=!1,groupId:t}=e;const n=(0,i.k6)(),l=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,s._X)(l),(0,r.useCallback)((e=>{if(!l)return;const a=new URLSearchParams(n.location.search);a.set(l,e),n.replace({...n.location,search:a.toString()})}),[l,n])]}function h(e){const{defaultValue:a,queryString:t=!1,groupId:n}=e,l=c(e),[o,i]=(0,r.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!p({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:l}))),[s,d]=m({queryString:t,groupId:n}),[u,h]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[n,l]=(0,f.Nk)(t);return[n,(0,r.useCallback)((e=>{t&&l.set(e)}),[t,l])]}({groupId:n}),k=(()=>{const e=s??u;return p({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{k&&i(k)}),[k]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),h(e)}),[d,h,l]),tabValues:l}}var k=t(2389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:a,block:t,selectedValue:i,selectValue:s,tabValues:d}=e;const f=[],{blockElementScrollPositionUntilNextRender:u}=(0,o.o5)(),c=e=>{const a=e.currentTarget,t=f.indexOf(a),n=d[t].value;n!==i&&(u(a),s(n))},p=e=>{let a=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=f.indexOf(e.currentTarget)+1;a=f[t]??f[0];break}case"ArrowLeft":{const t=f.indexOf(e.currentTarget)-1;a=f[t]??f[f.length-1];break}}a?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},a)},d.map((e=>{let{value:a,label:t,attributes:o}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:i===a?0:-1,"aria-selected":i===a,key:a,ref:e=>f.push(e),onKeyDown:p,onClick:c},o,{className:(0,l.Z)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":i===a})}),t??a)})))}function g(e){let{lazy:a,children:t,selectedValue:n}=e;if(t=Array.isArray(t)?t:[t],a){const e=t.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},t.map(((e,a)=>(0,r.cloneElement)(e,{key:a,hidden:e.props.value!==n}))))}function N(e){const a=h(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",b.tabList)},r.createElement(y,(0,n.Z)({},e,a)),r.createElement(g,(0,n.Z)({},e,a)))}function w(e){const a=(0,k.Z)();return r.createElement(N,(0,n.Z)({key:String(a)},e))}},7849:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>f,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>d,toc:()=>u});var n=t(7462),r=(t(7294),t(3905)),l=t(4866),o=t(5162);const i={slug:"/guides/datalayer-user-guide",title:"DataLayer\u2122 User Guide"},s=void 0,d={unversionedId:"guides/datalayer-user-guide",id:"guides/datalayer-user-guide",title:"DataLayer\u2122 User Guide",description:"Intro",source:"@site/docs/guides/datalayer-user-guide.md",sourceDirName:"guides",slug:"/guides/datalayer-user-guide",permalink:"/zh/guides/datalayer-user-guide",draft:!1,editUrl:"https://github.com/Chia-Network/{{ REPOSITORY_NAME }}/blob/main/docs/guides/datalayer-user-guide.md",tags:[],version:"current",frontMatter:{slug:"/guides/datalayer-user-guide",title:"DataLayer\u2122 User Guide"},sidebar:"guides",previous:{title:"WalletConnect Developer Guide",permalink:"/zh/walletconnect-developer-guide"},next:{title:"Simulator User Guide",permalink:"/zh/guides/simulator-user-guide"}},f={},u=[{value:"Intro",id:"intro",level:3},{value:"Proof of inclusion",id:"proof-of-inclusion",level:4},{value:"Example 1: Two-party commit",id:"example-1-two-party-commit",level:4},{value:"Example 2: NFT ratings",id:"example-2-nft-ratings",level:4},{value:"Resources and notes",id:"resources-and-notes",level:4},{value:"DataLayer Guide",id:"datalayer-guide",level:2},{value:"Install and Run Chia",id:"install-and-run-chia",level:3},{value:"Configure Chia to run DataLayer",id:"configure-chia-to-run-datalayer",level:3},{value:"Note on Maximum Key and Value Lengths",id:"note-on-maximum-key-and-value-lengths",level:2},{value:"Using DataLayer",id:"using-datalayer",level:2},{value:"Create a data store",id:"create-a-data-store",level:3},{value:"Add and Delete Keys",id:"add-and-delete-keys",level:3},{value:"View Keys and Values",id:"view-keys-and-values",level:3},{value:"View on-chain history",id:"view-on-chain-history",level:3},{value:"Create A Mirror to Advertise A Data Store",id:"create-a-mirror-to-advertise-a-data-store",level:3},{value:"Subscribe to a Data Store",id:"subscribe-to-a-data-store",level:3}],c={toc:u},p="wrapper";function m(e){let{components:a,...t}=e;return(0,r.kt)(p,(0,n.Z)({},c,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h3",{id:"intro"},"Intro"),(0,r.kt)("p",null,"This document will guide you through the process of setting up Chia's DataLayer\u2122 and running a few basic functions. Before using this guide, you may want to familiarize yourself with DataLayer's structure and function. Our ",(0,r.kt)("a",{parentName:"p",href:"https://www.chia.net/2022/09/20/enabling-data-for-web3-announcing-chia-datalayer/"},"blog post")," announcing DataLayer's launch is a great place to get started."),(0,r.kt)("h4",{id:"proof-of-inclusion"},"Proof of inclusion"),(0,r.kt)("p",null,"To expand upon a concept that was only covered briefly in the blog post, here is some more info about proof of inclusion:"),(0,r.kt)("p",null,"A proof of inclusion is a way to prove that a key/value pair is being stored, without needing to provide the entire Merke tree from the store. This is accomplished by creating a spend of the DataLayer singleton that accepts two things in its solution:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The hash of a key/value pair from the Merkle tree"),(0,r.kt)("li",{parentName:"ol"},"Proof that the same key/value pair actually exists in the Merkle tree. This proof is obtained by providing the minimum peer hashes necessary to recalculate the Merkle root that is currently stored on-chain, starting from the leaf obtained from the key/value pair.")),(0,r.kt)("p",null,"When this proof is obtained, the singleton announces the hash that exists in that DataLayer table.  "),(0,r.kt)("h4",{id:"example-1-two-party-commit"},"Example 1: Two-party commit"),(0,r.kt)("p",null,'"Two-party commit" is the simplest example of a proof of inclusion. It is an Offer where the owner of one DataLayer table offers to make an update if and only if the owner of another DataLayer table makes a specified update.'),(0,r.kt)("p",null,"A two-party commit uses an Offer that includes six asserts and spends."),(0,r.kt)("p",null,"In the original Offer, the maker includes:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A spend of the maker's DataLayer singleton to make the update to the maker's table"),(0,r.kt)("li",{parentName:"ol"},"A spend of the maker's DataLayer singleton to announce a proof of inclusion of the updates made"),(0,r.kt)("li",{parentName:"ol"},"An assert of an announcement from the taker of a proof of inclusion of a required update")),(0,r.kt)("p",null,"To accept the offer, the taker adds:"),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"A spend of the taker DataLayer singleton to make the update"),(0,r.kt)("li",{parentName:"ol"},"A spend of the taker DataLayer singleton to announce the proof of inclusion of the updated data"),(0,r.kt)("li",{parentName:"ol"},"An assert of the proof of inclusion from the maker")),(0,r.kt)("p",null,"The offer spendbundle only goes through when all of the necessary assertions are satisfied."),(0,r.kt)("p",null,"Where it gets interesting is what other coins might do with that announcement. Another coin can accept the key and value in its solution, hash them, and assert an announcement from the DataLayer coin of a proof of inclusion of that hash. If the assert succeeds, then the coin can confidently use that data in the key and value as a validated input to whatever it may want to do."),(0,r.kt)("h4",{id:"example-2-nft-ratings"},"Example 2: NFT ratings"),(0,r.kt)("p",null,"A hypothetical example of a proof of inclusion could be NFT ratings. Here's how it would work:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A critic provides ratings for various NFTs in a DataLayer table, such that people could create offers based on that rating."),(0,r.kt)("li",{parentName:"ul"},'A prospetive buyer might offer 5 XCH for any NFT with a "blue ribbon" rating from RatingWiz.'),(0,r.kt)("li",{parentName:"ul"},"To accept the offer, an NFT owner would have to include a proof of inclusion from the rating table that their NFT had that rating.")),(0,r.kt)("p",null,"This example would require anyone-can-spend DataLayer proofs of inclusion (these doesn't exist yet, but would be straightforward to build). The anyone-can-spend proof of inclusion could also generate a payment to the DataLayer table owner to pay RatingWiz for their services."),(0,r.kt)("h4",{id:"resources-and-notes"},"Resources and notes"),(0,r.kt)("p",null,"For additional technical resources, see the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/datalayer-rpc/",title:"DataLayer RPC API"},"DataLayer RPC API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/datalayer-cli/",title:"DataLayer CLI Reference"},"DataLayer CLI Reference"))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Commands that modify the blockchain include an optional fee. This fee can be specified in two ways:"),(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"-m")," / ",(0,r.kt)("inlineCode",{parentName:"li"},"--fee")," parameter can be specified explicitly in the command, as several of the examples in this document show"),(0,r.kt)("li",{parentName:"ol"},"If the fee option is not explicitly specified, then the ",(0,r.kt)("inlineCode",{parentName:"li"},"data_layer:fee")," setting in ",(0,r.kt)("inlineCode",{parentName:"li"},"~/.chia/mainnet/config/config.yaml")," will be used. By default, this is set to 1 billion mojos (0.001 XCH)"),(0,r.kt)("li",{parentName:"ol"},"If neither of these options is set, then no fee will be used\n:::")),(0,r.kt)("hr",{parentName:"admonition"})),(0,r.kt)("p",null,"If you have already installed Chia version 1.6 or greater and started the reference client, you may skip to the next section: ",(0,r.kt)("a",{parentName:"p",href:"#configure-chia-to-run-datalayer"},"Configure Chia to run DataLayer"),"."),(0,r.kt)("p",null,":::"),(0,r.kt)("h2",{id:"datalayer-guide"},"DataLayer Guide"),(0,r.kt)("h3",{id:"install-and-run-chia"},"Install and Run Chia"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Your firewall might give warnings when installing Chia. This is normal. Allow the installation to continue.")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Download the latest ",(0,r.kt)("a",{parentName:"p",href:"https://www.chia.net/download/"},"Chia installer"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Install Chia"))),(0,r.kt)("admonition",{title:"OS-Specific Instructions",type:"info"},(0,r.kt)(l.Z,{defaultValue:"windows",values:[{label:"Windows",value:"windows"},{label:"Linux",value:"linux"},{label:"MacOS",value:"macos"}],mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"windows",mdxType:"TabItem"},(0,r.kt)("div",{style:{textAlign:"left"}},(0,r.kt)("img",{src:"/img/data_layer/01_downloads_windows.png",alt:"Chia installation file"})),(0,r.kt)("p",{parentName:"admonition"},"Double click the .exe installer. The installation process will take less than 30 seconds on most computers."),"  "),(0,r.kt)(o.Z,{value:"linux",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"For Debian/Ubuntu Linux distributions, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo dpkg -i chia-blockchain_<version>_<arch>.deb\n")),(0,r.kt)("p",{parentName:"admonition"},"For other distributions, see ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/Chia-Network/chia-blockchain/wiki/INSTALL"},"the install Wiki"),"."),"  "),(0,r.kt)(o.Z,{value:"macos",mdxType:"TabItem"},(0,r.kt)("div",{style:{textAlign:"left"}},(0,r.kt)("img",{src:"/img/data_layer/02_downloads_mac.png",alt:"Chia installation file"})),(0,r.kt)("p",{parentName:"admonition"},"Double click the .dmg installer. After the installation completes, drag the Chia icon to the Applications folder."),"  "))),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Run the Chia reference wallet GUI:")),(0,r.kt)("admonition",{title:"OS-Specific Instructions",type:"info"},(0,r.kt)(l.Z,{defaultValue:"windows",values:[{label:"Windows",value:"windows"},{label:"Linux",value:"linux"},{label:"MacOS",value:"macos"}],mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"windows",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"The Chia reference wallet GUI will start automatically after the installation completes."),"  "),(0,r.kt)(o.Z,{value:"linux",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"Open a terminal window and run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia-blockchain &\n")),"  "),(0,r.kt)(o.Z,{value:"macos",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"Start Chia from your ",(0,r.kt)("em",{parentName:"p"},"Applications")," folder:"),(0,r.kt)("div",{style:{textAlign:"left"}},(0,r.kt)("img",{src:"/img/data_layer/03_start_chia_mac.png",alt:"Choose Farming Mode"})),"  "))),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"If this is your first time installing Chia on this machine, the ",(0,r.kt)("inlineCode",{parentName:"li"},"Select Your Client Mode")," dialog will appear:")),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/04_wallet_farming_mode.png",alt:"Choose Farming Mode"})),(0,r.kt)("br",null),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"If you select ",(0,r.kt)("inlineCode",{parentName:"li"},"Farming Mode"),", you will run a full node",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Advantage: your wallet will respond faster than it would in ",(0,r.kt)("inlineCode",{parentName:"li"},"Wallet Mode")),(0,r.kt)("li",{parentName:"ul"},"Disadvantage: you need to sync the blockchain database, which can take several days if you are starting from the genesis block"))),(0,r.kt)("li",{parentName:"ul"},"If you select ",(0,r.kt)("inlineCode",{parentName:"li"},"Wallet Mode"),", you will only run a light wallet",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Advantage: no need to sync a full node"),(0,r.kt)("li",{parentName:"ul"},"Disadvantage: slower wallet performance"))),(0,r.kt)("li",{parentName:"ul"},"Most users should select ",(0,r.kt)("inlineCode",{parentName:"li"},"Farming Mode"),", in order to gain the long-term performance advantage of running a full node")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"If you don't already have a Chia private key (wallet), you will need to create one now. If you already have a private key, proceed to step 6.")),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/05_create_private_key.png",alt:"Create a private key"})),(0,r.kt)("br",null),(0,r.kt)("p",null,"You will be shown a list of 24 words. Copy these words to a private location. Order is important."),(0,r.kt)("admonition",{title:"important",type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"Your seed phrase is all that is required to recover your wallet. If you lose your seed phrase, recovery will not be possible. If a bad actor gains access to your seed phrase, they'll be able to steal your Chia. Do not take a picture of your seed phrase or store it on a computer.")),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/06_seed_phrase.png",alt:"24-word seed phrase"}),(0,r.kt)("figcaption",null,(0,r.kt)("em",null,"Carefully copy your mnemonic seed phrase for future wallet recovery."))),(0,r.kt)("br",null),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"Select Key")," dialog will appear. If you see multiple keys, select one that has some XCH (if possible).")),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/07_choose_key.png",alt:"Select Key dialog"}),(0,r.kt)("figcaption",null,(0,r.kt)("em",null,"If the Select Key dialog appears, choose your primary key."))),(0,r.kt)("br",null),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},'Your wallet will begin syncing. "WALLET" will appear in the upper right corner. The orange dot indicates that the wallet is syncing. You may proceed to the next step while syncing is in progress.')),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/08_not_synced.png",alt:"Not synced"}),(0,r.kt)("figcaption",null,(0,r.kt)("em",null,"The wallet is syncing."))),(0,r.kt)("br",null),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"Open PowerShell on Windows, or Terminal on Linux and MacOS.")),(0,r.kt)("p",null,"We'll create an alias to run the ",(0,r.kt)("inlineCode",{parentName:"p"},"chia")," command from any folder. We'll also fix any SSL permissions issues. Run the following command(s):"),(0,r.kt)("admonition",{title:"Chia setup",type:"info"},(0,r.kt)(l.Z,{defaultValue:"windows",values:[{label:"Windows",value:"windows"},{label:"Linux",value:"linux"},{label:"MacOS",value:"macos"}],mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"windows",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"(Be sure to update ","<","username",">"," and ","<","version",">"," to match the actual folder structure)"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"Set-Alias -Name chia C:\\Users\\<username>\\AppData\\Local\\Programs\\Chia\\resources\\app.asar.unpacked\\daemon\\chia.exe\n")),"  "),(0,r.kt)(o.Z,{value:"linux",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"Alias command is not needed, but you should still run the following:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia init --fix-ssl-permissions\n")),"  "),(0,r.kt)(o.Z,{value:"macos",mdxType:"TabItem"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"alias chia='/Applications/Chia.app/Contents/Resources/app.asar.unpacked/daemon/chia'\nchia init --fix-ssl-permissions\n")),"  "))),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"chia version"),". You should be shown the correct version. For example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"chia version\n1.6.0\n")),(0,r.kt)("ol",{start:10},(0,r.kt)("li",{parentName:"ol"},"(optional) Run ",(0,r.kt)("inlineCode",{parentName:"li"},"chia configure --set-log-level INFO"),". This will instruct your Chia installation to log more info than it would have with the default level of WARNING:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia configure --set-log-level INFO\n")),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"Logging level updated. Check ~/.chia/mainnet/log/debug.log\nRestart any running chia services for changes to take effect\n")),(0,r.kt)("p",null,"(You will restart Chia later in this guide.)"),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},"Acquire some XCH. 0.01 XCH is a sufficient amount to get started.")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you ever need to display your address, run ",(0,r.kt)("inlineCode",{parentName:"p"},"chia keys show"),". This command will only output your public keys and address; your private keys and seed phrase will not be shown.")),(0,r.kt)("h3",{id:"configure-chia-to-run-datalayer"},"Configure Chia to run DataLayer"),(0,r.kt)("p",null,"At this point, you should have installed and started Chia. You should also have a synced wallet with some XCH (0.01 XCH is sufficient to get started). You do ",(0,r.kt)("em",{parentName:"p"},"not")," need a synced full node."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"You are recommended to complete steps 1 and 2 (port forwarding and firewall configuration) in order to run DataLayer. If you skip these steps, DataLayer might not run properly.")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Configure your router to forward port 8575 (data propagation server) to your local machine. To configure your router's settings, typically you will need enter ",(0,r.kt)("inlineCode",{parentName:"p"},"http://192.168.1.1")," in a web browser, though this address varies for different routers. From your router's settings, locate the Port Forwarding section and add a rule to forward port 8575 to your local IP address.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"You will also need to configure your computer's firewall to allow connections on port 8575. This process is different for each OS:"))),(0,r.kt)("admonition",{title:"Firewall setup",type:"info"},(0,r.kt)(l.Z,{defaultValue:"windows",values:[{label:"Windows",value:"windows"},{label:"Linux",value:"linux"},{label:"MacOS",value:"macos"}],mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"windows",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"From a PowerShell prompt, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"start-Process powershell -Verb runAs\n")),(0,r.kt)("p",{parentName:"admonition"},"This will open a new PowerShell window as an Administrator. From this new window, you will need to run four commands, two for incoming connections and two for outgoing connections."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'netsh advfirewall firewall add rule name="allowDataServerIn" dir=in action=allow protocol=TCP localport=8575\nnetsh advfirewall firewall add rule name="allowDataServerOut" dir=out action=allow protocol=TCP localport=8575\n')),(0,r.kt)("p",{parentName:"admonition"},"Each of these commands should give a response of ",(0,r.kt)("inlineCode",{parentName:"p"},"Ok.")," Once you have successfully run the commands, exit the Administrator PowerShell window."),"  "),(0,r.kt)(o.Z,{value:"linux",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"Assuming you use iptables, which is installed on most distributions by default, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo iptables -I INPUT -p tcp -m tcp --dport 8575 -j ACCEPT\nsudo iptables -I OUTPUT -p tcp -m tcp --dport 8575 -j ACCEPT\n")),(0,r.kt)("p",{parentName:"admonition"},"Next, save the settings. For Ubuntu and Debian, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo /sbin/iptables-save\n")),(0,r.kt)("p",{parentName:"admonition"},"For CentOS, Red Hat, and Fedora, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"/sbin/service iptables save\n")),"  "),(0,r.kt)(o.Z,{value:"macos",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"Open /etc/pf.conf in a text editor. You will need administrative privileges. For example:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo vi /etc/pf.conf\n")),(0,r.kt)("p",{parentName:"admonition"},"Add the following lines to the end of the file:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# Open port 8575 for Chia Data Propagation Server\npass in proto tcp from any to any port 8575\n")),(0,r.kt)("p",{parentName:"admonition"},"Save and close the file."),(0,r.kt)("p",{parentName:"admonition"},"To load the changes, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo pfctl -f /etc/pf.conf\n")),(0,r.kt)("p",{parentName:"admonition"},"To verify that the changes are active, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo pfctl -sr | grep 8575\n")),"  "))),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Start the DataLayer services from the GUI:")),(0,r.kt)("p",null,"(For CLI instructions, skip ahead to step 5.)"),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/09_start_data.png",alt:"Start the DataLayer services"}),(0,r.kt)("figcaption",null,(0,r.kt)("em",null,"Enable DataLayer services."))),(0,r.kt)("br",null),(0,r.kt)("p",null,"As shown in the above image:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click ",(0,r.kt)("inlineCode",{parentName:"li"},"Settings")," on the lower left side of your wallet"),(0,r.kt)("li",{parentName:"ul"},"Click the ",(0,r.kt)("inlineCode",{parentName:"li"},"DATA LAYER")," menu"),(0,r.kt)("li",{parentName:"ul"},"Click the slider to ",(0,r.kt)("inlineCode",{parentName:"li"},"Enable Data Layer")),(0,r.kt)("li",{parentName:"ul"},"A slider titled ",(0,r.kt)("inlineCode",{parentName:"li"},"Enable File Propagation Server")," will appear. Click this to enable it as well")),(0,r.kt)("p",null,"Finally, you need to restart Chia. Close the GUI and run steps 3 and 6 above. When Chia starts, it will automatically enable both of the DataLayer services."),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"If the dot to the left of ",(0,r.kt)("inlineCode",{parentName:"li"},"WALLET")," is green (indicating that your wallet is synced), then you may proceed. If it is still orange, then you need to wait for it turn green before continuing.")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Regardless of the status of ",(0,r.kt)("inlineCode",{parentName:"p"},"FULL NODE"),", you may safely proceed with this tutorial:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Orange dot = full node is syncing"),(0,r.kt)("li",{parentName:"ul"},"Green dot = full node is synced"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"FULL NODE")," is missing = you are running in ",(0,r.kt)("inlineCode",{parentName:"li"},"Wallet Mode")))),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("img",{src:"/img/data_layer/10_synced.png",alt:"Synced wallet"})),(0,r.kt)("br",null),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Start the DataLayer services from the CLI")),(0,r.kt)("p",null,"(You can safely skip this step if you already started the DataLayer services from the GUI.)"),(0,r.kt)("p",null,"First, start the DataLayer service:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia start data\n")),(0,r.kt)("p",null,"Result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia_data_layer: started\n")),(0,r.kt)("p",null,"Next, start the File Propagation Server:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia start data_layer_http\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia_data_layer_http: started\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Chia and the DataLayer are now installed and configured properly.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"note-on-maximum-key-and-value-lengths"},"Note on Maximum Key and Value Lengths"),(0,r.kt)("p",null,"You may be wondering how much data DataLayer can handle. When testing locally, there are a few important points to consider:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"There is no enforced limit on the length of DataLayer keys or values"),(0,r.kt)("li",{parentName:"ul"},"However, your computer must have enough memory (and other resources) to store the keys and values it downloads. A Raspberry Pi with 4 GB of memory will not be able to support the same size data sets as a server with 512 GB of memory"),(0,r.kt)("li",{parentName:"ul"},"Additionally, when adding a single key/value pair, the total size of the pair must fit into memory (the individual sizes of the key and value don't matter)"),(0,r.kt)("li",{parentName:"ul"},"When running ",(0,r.kt)("inlineCode",{parentName:"li"},"update_data_store")," to add multiple keys, the important metric is the total size of ",(0,r.kt)("em",{parentName:"li"},"all")," keys and values in the whole store. Individual keys and values within the same command are unimportant in this context"),(0,r.kt)("li",{parentName:"ul"},"When discussing the lengths of keys and values, we always refer to the ",(0,r.kt)("em",{parentName:"li"},"hex")," values ",(0,r.kt)("em",{parentName:"li"},"after")," conversion from their original format"),(0,r.kt)("li",{parentName:"ul"},"The amount of data in your request must be smaller than the value of ",(0,r.kt)("inlineCode",{parentName:"li"},"rpc_server_max_request_body_size"),", a parameter located in ",(0,r.kt)("inlineCode",{parentName:"li"},"~/.chia/mainnet/config/config.yaml"),". If you modify this setting, you must restart Chia in order for the change to take effect")),(0,r.kt)("p",null,"Keeping all of this in mind, ",(0,r.kt)("strong",{parentName:"p"},"it is typically safe to insert data sets of up to 50 MiB")," (no guarantees, though). We expect to support larger sizes in future versions. For now, however, we have only done minimal testing on larger data sets. For example, using ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," to add keys and values to an empty tree required the following lengths of time:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"100 MiB -- 2 to 4 seconds"),(0,r.kt)("li",{parentName:"ul"},"1 GiB -- 45 to 60 seconds"),(0,r.kt)("li",{parentName:"ul"},"2 GiB -- failed to insert")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"using-datalayer"},"Using DataLayer"),(0,r.kt)("p",null,"Chia DataLayer doesn't have a GUI. The commands in this tutorial will use the command line interface (CLI). As a reminder, here is the complete reference for the CLI, as well as all available Remote Procedure Calls (RPCs):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/datalayer-rpc/",title:"DataLayer RPC API"},"DataLayer RPC API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/datalayer-cli/",title:"DataLayer CLI Reference"},"DataLayer CLI Reference"))),(0,r.kt)("h3",{id:"create-a-data-store"},"Create a data store"),(0,r.kt)("p",null,"This requires an on-chain transaction."),(0,r.kt)("p",null,"The command to create a new store is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data create_data_store -m <fee>\n")),(0,r.kt)("p",null,"Note that ",(0,r.kt)("inlineCode",{parentName:"p"},"<fee>")," is a standard transaction fee to use Chia's network. This fee is in XCH."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"create_data_store example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data create_data_store -m 0.00001\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{\n    'id': '1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f',\n    'success': True,\n    'txs':\n    [\n        {\n            'additions':\n            [\n                {\n                    'amount': 1,\n                    'parent_coin_info': '0xb4a1a658aaefd10930ecbccd51ac2c9a4853435b14acdb0de84729bfbefc791c',\n                    'puzzle_hash': '0xeff07522495060c066f66f32acc2a77e3a3e737aca8baea4d1a64ea4cdc13da9'\n                },\n                {\n                    'amount': 14999989999999,\n                    'parent_coin_info': '0xb4a1a658aaefd10930ecbccd51ac2c9a4853435b14acdb0de84729bfbefc791c',\n                    'puzzle_hash': '0x478255c372cec71557c20459f4b690fb1b7c57da3fcfc4b6396d78d9a396e384'\n                },\n                {\n                    'amount': 1,\n                    'parent_coin_info': '0x1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f',\n                    'puzzle_hash': '0xd650e81d45c7381183c14c3363a81aa78cb3acfe213e46da26df75cd431557f9'\n                }\n            ],\n            'amount': 1,\n            'confirmed': False,\n            'confirmed_at_height': 0,\n            'created_at_time': 1661141324,\n            'fee_amount': 10000000,\n            'memos': [],\n            'name': '0xaee362ae9d0ce3992b3bfb7cc48bde17f3d794cc383ff1d5e49a4d75dbf004d6',\n            'removals':\n            [\n                {\n                    'amount': 15000000000000,\n                    'parent_coin_info': '0x81fc1729bad3f19699461b1ee455a92493ef4c1d60ba37d22ac187a18367e08e',\n                    'puzzle_hash': '0x221c0e9cd9b7f536e9a204ef93519e6c9d4b4c9a049bde8d66fa1816c23120d2'\n                },\n                {\n                    'amount': 1,\n                    'parent_coin_info': '0xb4a1a658aaefd10930ecbccd51ac2c9a4853435b14acdb0de84729bfbefc791c',\n                    'puzzle_hash': '0xeff07522495060c066f66f32acc2a77e3a3e737aca8baea4d1a64ea4cdc13da9'\n                }\n            ],\n            'sent': 10,\n            'sent_to': [],\n            'spend_bundle': {\n                'aggregated_signature': '0x8c431f07698ad69fd14ab04d77683801e6b908e441074f5ef5268350483d194a09a8b3cde681cb5c5fcf6444e0c9d4bf00999e8e6ad1522891baa590f82d92e2876b08e34b1f3156d0fe88ce206e5ed1567863e10a0397fd0a8a66bcbd5007b0',\n                'coin_spends':\n                [\n                    {\n                        'coin':\n                        {\n                            'amount': 15000000000000,\n                            'parent_coin_info': '0x81fc1729bad3f19699461b1ee455a92493ef4c1d60ba37d22ac187a18367e08e',\n                            'puzzle_hash': '0x221c0e9cd9b7f536e9a204ef93519e6c9d4b4c9a049bde8d66fa1816c23120d2'\n                        },\n                        'puzzle_reveal': '0xff02ffff01ff02ffff01ff02ffff03ff0bffff01ff02ffff03ffff09ff05ffff1dff0bffff1effff0bff0bffff02ff06ffff04ff02ffff04ff17ff8080808080808080ffff01ff02ff17ff2f80ffff01ff088080ff0180ffff01ff04ffff04ff04ffff04ff05ffff04ffff02ff06ffff04ff02ffff04ff17ff80808080ff80808080ffff02ff17ff2f808080ff0180ffff04ffff01ff32ff02ffff03ffff07ff0580ffff01ff0bffff0102ffff02ff06ffff04ff02ffff04ff09ff80808080ffff02ff06ffff04ff02ffff04ff0dff8080808080ffff01ff0bffff0101ff058080ff0180ff018080ffff04ffff01b0b3deeeb00319624e26767c5cf777cf9a02d046510181ed29f233e2847fa8ef28ede05d2770bb1b8f101ea8ae20527d61ff018080',\n                        'solution': '0xff80ffff01ffff33ffa0eff07522495060c066f66f32acc2a77e3a3e737aca8baea4d1a64ea4cdc13da9ff0180ffff33ffa0478255c372cec71557c20459f4b690fb1b7c57da3fcfc4b6396d78d9a396e384ff860da47513597f80ffff34ff840098968080ffff3cffa084f72a9a3ce5152e1d627a259a0c1c90e6af389cb26af48173d84e374ecc518080ffff3dffa03a0ed375dff192685d1ef9a74424788b04655700bee898f0ea8445f8b55d38338080ff8080'\n                    },\n                    {\n                        'coin':\n                        {\n                            'amount': 1,\n                            'parent_coin_info': '0xb4a1a658aaefd10930ecbccd51ac2c9a4853435b14acdb0de84729bfbefc791c',\n                            'puzzle_hash': '0xeff07522495060c066f66f32acc2a77e3a3e737aca8baea4d1a64ea4cdc13da9'\n                        },\n                        'puzzle_reveal': '0xff02ffff01ff04ffff04ff04ffff04ff05ffff04ff0bff80808080ffff04ffff04ff0affff04ffff02ff0effff04ff02ffff04ffff04ff05ffff04ff0bffff04ff17ff80808080ff80808080ff808080ff808080ffff04ffff01ff33ff3cff02ffff03ffff07ff0580ffff01ff0bffff0102ffff02ff0effff04ff02ffff04ff09ff80808080ffff02ff0effff04ff02ffff04ff0dff8080808080ffff01ff0bffff0101ff058080ff0180ff018080',\n                        'solution': '0xffa0d650e81d45c7381183c14c3363a81aa78cb3acfe213e46da26df75cd431557f9ff01ffffa00000000000000000000000000000000000000000000000000000000000000000ffa0adcbcbaf4594e8d3057ea3a64a40560720ede80e720f867d2631069c27459de58080'\n                    }\n                ]\n            },\n            'to_puzzle_hash': '0x0202020202020202020202020202020202020202020202020202020202020202',\n            'trade_id': None,\n            'type': 0,\n            'wallet_id': 0\n        },\n        {\n            'additions':\n            [\n                {\n                    'amount': 1,\n                    'parent_coin_info': '0xb4a1a658aaefd10930ecbccd51ac2c9a4853435b14acdb0de84729bfbefc791c',\n                    'puzzle_hash': '0xeff07522495060c066f66f32acc2a77e3a3e737aca8baea4d1a64ea4cdc13da9'\n                },\n                {\n                    'amount': 14999989999999,\n                    'parent_coin_info': '0xb4a1a658aaefd10930ecbccd51ac2c9a4853435b14acdb0de84729bfbefc791c',\n                    'puzzle_hash': '0x478255c372cec71557c20459f4b690fb1b7c57da3fcfc4b6396d78d9a396e384'\n                }\n            ],\n            'amount': 1,\n            'confirmed': False,\n            'confirmed_at_height': 0,\n            'created_at_time': 1661141324,\n            'fee_amount': 10000000,\n            'memos': [],\n            'name': '0xbb4cb461126d9ea9492e767462b9a4e408e497231c2093474cba2bcfe4397104',\n            'removals':\n            [\n                {\n                    'amount': 15000000000000,\n                    'parent_coin_info':\n                    '0x81fc1729bad3f19699461b1ee455a92493ef4c1d60ba37d22ac187a18367e08e',\n                    'puzzle_hash': '0x221c0e9cd9b7f536e9a204ef93519e6c9d4b4c9a049bde8d66fa1816c23120d2'\n                }\n            ],\n            'sent': 0,\n            'sent_to': [],\n            'spend_bundle': None,\n            'to_puzzle_hash': '0xeff07522495060c066f66f32acc2a77e3a3e737aca8baea4d1a64ea4cdc13da9',\n            'trade_id': None,\n            'type': 1,\n            'wallet_id': 1\n        }\n    ]\n}\n"))),(0,r.kt)("p",null,"The only value you need from the JSON blob is ",(0,r.kt)("inlineCode",{parentName:"p"},"id"),", the first value in the output. In the above example, this was"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"'id': '1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f',\n")),(0,r.kt)("p",null,"You can't do anything with this store until it is confirmed on-chain. To check the status of this confirmation, run the ",(0,r.kt)("inlineCode",{parentName:"p"},"get_root")," command, passing in the ",(0,r.kt)("inlineCode",{parentName:"p"},"id"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"get_root example 1"),(0,r.kt)("p",null,"Your data store will be empty when you first create it. In this case, ",(0,r.kt)("inlineCode",{parentName:"p"},"get_root")," will return an empty hash:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data get_root --id 1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{\n    'confirmed': True,\n    'hash': '0x0000000000000000000000000000000000000000000000000000000000000000',\n    'success': True,\n    'timestamp': 1661148563\n}\n"))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"get_root example 2"),(0,r.kt)("p",null,"After you have added at least one key, ",(0,r.kt)("inlineCode",{parentName:"p"},"get_root")," will return a real hash:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data get_root --id 1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{\n    'confirmed': True,\n    'hash': '0xd6d6b4d6bbd77aaa5927c8a21a1451b35f4860a7f9a58e51dae04037da9c08e8',\n    'success': True,\n    'timestamp': 1661148611\n}\n"))),(0,r.kt)("h3",{id:"add-and-delete-keys"},"Add and Delete Keys"),(0,r.kt)("p",null,"This requires an on-chain transaction."),(0,r.kt)("p",null,"Use ",(0,r.kt)("inlineCode",{parentName:"p"},"update_data_store")," to modify your singleton. Actions include ",(0,r.kt)("inlineCode",{parentName:"p"},"insert")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"delete"),". These can also be chained together."),(0,r.kt)("p",null,"For more example of using this command, see the ",(0,r.kt)("a",{parentName:"p",href:"/datalayer-cli#update_data_store"},"CLI reference"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"update_data_store -- insert example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'chia data update_data_store --id=1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f -d \'[{"action":"insert", "key":"0003", "value":"abc123"}]\'\n')),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{\n    'success': True,\n    'tx_id': '0xed157b50b94a849d3d19a0ef4e1b0e07bda863e4d65bd1527fa6f59062bb5c78'\n}\n"))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"update_data_store -- delete example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'chia data update_data_store --id 1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f --changelist \'[{"action":"delete", "key":"0003"}]\'\n')),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{\n    'success': True,\n    'tx_id': '0x2a64ef42baf05c6f4d446ba8638c2f2b2c26e5a91ad62e0c5151df40d0f92ec2'\n}\n"))),(0,r.kt)("h3",{id:"view-keys-and-values"},"View Keys and Values"),(0,r.kt)("p",null,"You can view the keys and values with ",(0,r.kt)("inlineCode",{parentName:"p"},"get_keys_values"),". This command will only return data that has been confirmed on-chain -- if you run it immediately after adding data, it may not return the keys you expect."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"get_keys_values example"),(0,r.kt)("p",null,"For this example, there are two keys in the store:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data get_keys_values --id 1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"{\n    'keys_values': [\n        {\n            'atom': None,\n            'hash': '0x7e193b814080e50aa7780bcf71fd0422a0397ad3e57dc1eac71d93183efb39ba',\n            'key': '0x0004',\n            'value': '0x123abc'\n        },\n        {\n            'atom': None,\n            'hash': '0xc2dc94c2a85d7db4cfdd1d907bcc441c8fce595db2e2075b973fb8171e2f19a2',\n            'key': '0x0005',\n            'value': '0xbeadfeed'\n        }\n    ],\n    'success': True\n}\n"))),(0,r.kt)("h3",{id:"view-on-chain-history"},"View on-chain history"),(0,r.kt)("p",null,"Use ",(0,r.kt)("inlineCode",{parentName:"p"},"get_root_history")," to view the on-chain history of the root hash."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"get_root_history example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data get_root_history --id 1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{\n    'root_history': [\n        {\n            'confirmed': True,\n            'root_hash': '0x0000000000000000000000000000000000000000000000000000000000000000',\n            'timestamp': 1661141342\n        },\n        {\n            'confirmed': True,\n            'root_hash': '0xe488fa1bf0f712b224df0daf312b3d479f80e3a330d4bebd8f26a0d52dc0ebbb',\n            'timestamp': 1661144917\n        },\n        {\n            'confirmed': True,\n            'root_hash': '0x0000000000000000000000000000000000000000000000000000000000000000',\n            'timestamp': 1661145223\n        },\n        {\n            'confirmed': True,\n            'root_hash': '0xb5420e65846ded936d1e4855c066247fc461a3b281cd9e0e69f3cfa4df529ba2',\n            'timestamp': 1661145404\n        },\n        {\n            'confirmed': True,\n            'root_hash': '0xd6d6b4d6bbd77aaa5927c8a21a1451b35f4860a7f9a58e51dae04037da9c08e8',\n            'timestamp': 1661148611\n        }\n    ],\n    'success': True\n}\n"))),(0,r.kt)("h3",{id:"create-a-mirror-to-advertise-a-data-store"},"Create A Mirror to Advertise A Data Store"),(0,r.kt)("p",null,"This requires an on-chain transaction."),(0,r.kt)("p",null,"We include an HTTP server that can be used out of the box. By default it listens to port 8575."),(0,r.kt)("p",null,'To "advertise" your mirror on-chain you use the ',(0,r.kt)("inlineCode",{parentName:"p"},"add_mirror")," command. This command takes three arguments:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"i")," -- Your root's ID"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"u")," -- The URL of your mirror. You can reuse this argument, as shown in the example below"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"a")," -- The amount (in mojos) that will be locked into the mirror while it exists. In theory, a system could prioritize mirrors according to how much was spent to create them. The ",(0,r.kt)("inlineCode",{parentName:"li"},"amount")," will be returned to the creator when the mirror is deleted. Minimum ",(0,r.kt)("inlineCode",{parentName:"li"},"amount")," is 0")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"add_mirror example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data add_mirror -i 67b5e98abd5fef1a1c44ee63077bc5ef75c6cc4dadc9fd52d63a343922ce496b -u http://www.example2.com:8575 -u http://10.1.1.32:8575/ -a 1000\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"None\n"))),(0,r.kt)("p",null,"The HTTP server will serve files that are generated by default in the ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.chia/mainnet/data_layer/db/server_files_location_mainnet")," directory."),(0,r.kt)("p",null,"Note that you can mirror any Data Store, not just your own."),(0,r.kt)("h3",{id:"subscribe-to-a-data-store"},"Subscribe to a Data Store"),(0,r.kt)("p",null,"You can subscribe to a data store in order to watch for changes and download the data from published mirrors by using the ",(0,r.kt)("inlineCode",{parentName:"p"},"subscribe")," command:"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"subscribe example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia data subscribe -store 8f6ed792bbbf5216f8e55064793f74ce01286b9c1d542cc4a357cf7f8712df1d\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"None\n")),(0,r.kt)("p",null,"Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"subscriptions")," RPC to list all current subscriptions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chia rpc data_layer subscriptions\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{\n    "store_ids": [\n        "1a119374fc7d7055d3419fdcd7f93065f28a1e4acacdf9c73b933b27b685550f",\n        "8f6ed792bbbf5216f8e55064793f74ce01286b9c1d542cc4a357cf7f8712df1d"\n    ],\n    "success": true\n}\n'))),(0,r.kt)("p",null,"Once subscribed, you will automatically try to download updates from any published mirrors for that singleton. You can use the earlier mentioned commands ",(0,r.kt)("inlineCode",{parentName:"p"},"get_root_history")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"get_keys_values")," to look at the history and data of any subscribed data stores. The HTTP server will automatically start to publish data for all subscribed data stores. However, it won't be advertised on-chain unless you specifically use ",(0,r.kt)("inlineCode",{parentName:"p"},"add_mirror"),"."))}m.isMDXComponent=!0}}]);